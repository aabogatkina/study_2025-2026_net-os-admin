---
# Preamble

## Author
author:
  name: Богаткина Алёна Александровна
  degrees: DSc
  email: 1132231437@pfur.ru
  affiliation:
    - name: Российский университет дружбы народов
      country: Российская Федерация
      postal-code: 117198
      city: Москва
      address: ул. Миклухо-Маклая, д. 6

## Title
title: Презентация по лабораторной работе №9
subtitle: Администрирование сетевых подситем
license: CC BY
date: 2025-10-28

## Generic options
lang: ru-RU
crossref:
  lof-title: Список иллюстраций
  lot-title: Список таблиц
  lol-title: Листинги

## Fonts 
mainfont: DejaVu Sans
romanfont: DejaVu Sans 
sansfont: DejaVu Sans 
monofont: DejaVu Sans Mono 
mainfontoptions: Ligatures=TeX 
romanfontoptions: Ligatures=TeX 
sansfontoptions: Ligatures=TeX,Scale=MatchLowercase 
monofontoptions: Scale=MatchLowercase,Scale=0.9

## Formats
format:
### Pdf output format
  beamer:
    toc: true
    toc-title: Содержание
    number-sections: true
    colorlinks: false
    toc-depth: 2
    slide_level: 2
    aspectratio: 169
    section-titles: true
    theme: metropolis
    themeoptions: progressbar=frametitle,sectionpage=progressbar,numbering=fraction
    pdf-engine: xelatex
    fontenc: T2A
#### Language
    babel-lang: russian
    babel-otherlangs: english

### Html output
  revealjs:
    transition: slide
    margin: 0.2
    smaller: false
    output-ext: html
    theme: beige
    logo: _resources/image/logo_rudn.png
---

# Вводная часть

## Цель работы

Приобретение практических навыков по установке и простейшему конфигурированию POP3/IMAP-сервера.

# Выполнение лабораторной работы

## Установка Dovecot

Загрузили нашу операционную систему и перешли в рабочий каталог с проектом. Запустили виртуальную машину server. Далее на виртуальной машине server вошли под созданным нами пользователем и открыли терминал. Перешли в режим суперпользователя: ```sudo -i``` ([рис. @fig-001])

![Переход в режим суперпользователя](image/1.png){#fig-001 width=70%}

## Установка Dovecot

Далее установили необходимые для работы пакеты: ```dnf -y install dovecot telnet``` ([рис. @fig-002])

![Установка Dovecot](image/2.png){#fig-002 width=50%}

## Настройка Dovecot

В конфигурационном файле /etc/dovecot/dovecot.conf прописали список почтовых протоколов, по которым разрешено работать Dovecot: ```protocols = imap pop3```([рис. @fig-003])

![Cписок почтовых протоколов, по которым разрешено работать Dovecot](image/3.png){#fig-003 width=50%}

## Настройка Dovecot

В конфигурационном файле /etc/dovecot/conf.d/10-auth.conf проверили, что указан метод аутентификации plain: ```auth_mechanisms = plain```([рис. @fig-004])

![Проверка метода аутентификации](image/4.png){#fig-004 width=70%}

## Настройка Dovecot

В конфигурационном файле /etc/dovecot/conf.d/auth-system.conf.ext проверили, что для поиска пользователей и их паролей используется pam и файл passwd: ([рис. @fig-005]), ([рис. @fig-006])

![Проверка поиска pam](image/5-1.png){#fig-005 width=60%}

## Настройка Dovecot

![Проверка поиска passwd](image/5-2.png){#fig-006 width=60%}

## Настройка Dovecot

В конфигурационном файле /etc/dovecot/conf.d/10-mail.conf настроили месторасположение почтовых ящиков пользователей: ```mail_location = maildir:~/Maildir``` ([рис. @fig-007])

![Настройка месторасположения почтовых ящиков](image/6.png){#fig-007 width=70%}

## Настройка Dovecot

Всю работу с конфигурационными файлами производили через ```nano``` ([рис. @fig-008])

![Работа с конфигурационными файлами](image/3-4-5-6.png){#fig-008 width=70%}

## Настройка Dovecot

В Postfix задали каталог для доставки почты: ```postconf -e 'home_mailbox = Maildir/'``` ([рис. @fig-009])

![Задание каталога для доставки почты](image/7.png){#fig-009 width=70%}

## Настройка Dovecot

Далее сконфигурировали межсетевой экран, разрешив работать службам протоколов POP3 и IMAP ([рис. @fig-010]):

![Конфигурация межсетевого экрана, разрешение работать службам протоколов POP3 и IMAP](image/8.png){#fig-010 width=50%}

## Настройка Dovecot

Восстановили контекст безопасности в SELinux: ```restorecon -vR /etc``` ([рис. @fig-011])

![Восстановление контекста безопасности в SELinux](image/9.png){#fig-011 width=70%}

## Настройка Dovecot

Перезапустили Postfix и запустили Dovecot ([рис. @fig-012]):

![Перезапуск Postfix и запуск Dovecot](image/10.png){#fig-012 width=70%}

## Проверка работы Dovecot

На дополнительном терминале виртуальной машины server запустили мониторинг работы почтовой службы: ```tail -f /var/log/maillog``` ([рис. @fig-013])

![Мониторинг работы почтовой службы](image/11.png){#fig-013 width=70%}

## Проверка работы Dovecot

На терминале сервера для просмотра имеющейся почты использовали ```MAIL=~/Maildir mail``` ([рис. @fig-014])

![Просмотр имеющейся почты](image/12.png){#fig-014 width=70%}

## Проверка работы Dovecot

Для просмотра mailbox пользователя на сервере на терминале с правами суперпользователя использовали команду ```doveadm mailbox list -u aabogatkina``` ([рис. @fig-015])

![Просмотр mailbox](image/13.png){#fig-015 width=70%}

## Проверка работы Dovecot

Далее загрузили виртуальную машину client, вошли под нашим пользователем и открыли терминал. Там перешли в режим суперпользователя ([рис. @fig-016])

![Переход в режим суперпользователя на client](image/14.png){#fig-016 width=70%}

## Проверка работы Dovecot

Установили почтовый клиент: ```dnf -y install evolution``` ([рис. @fig-017])

![Установка почтового клиента на client](image/15.png){#fig-017 width=50%}

## Проверка работы Dovecot

Запустили и настройте почтовый клиент Evolution ([рис. @fig-018]), ([рис. @fig-019]), ([рис. @fig-020]), ([рис. @fig-021]), ([рис. @fig-022]):

![Запуск почтового клиента Evolution](image/16-1.png){#fig-018 width=70%}

## Проверка работы Dovecot

![Настройка почтового клиента Evolution (1)](image/16-2.png){#fig-019 width=50%}

## Проверка работы Dovecot

![Настройка почтового клиента Evolution (2)](image/16-3.png){#fig-020 width=50%}

## Проверка работы Dovecot

![Настройка почтового клиента Evolution (3)](image/16-4.png){#fig-021 width=50%}

## Проверка работы Dovecot

![Настройка почтового клиента Evolution (4)](image/16-5.png){#fig-022 width=70%}

## Проверка работы Dovecot

Из почтового клиента отправили себе несколько тестовых писем, убедились, что они доставлены ([рис. @fig-023]), ([рис. @fig-024]), ([рис. @fig-025]), ([рис. @fig-026])

![Отправка себе тестового письма из почтового клиента (1)](image/17-1.png){#fig-023 width=40%}

## Проверка работы Dovecot

![Отправка себе тестового письма из почтового клиента (2)](image/17-2.png){#fig-024 width=50%}

## Проверка работы Dovecot

![Отправка себе тестового письма из почтового клиента (3)](image/17-3.png){#fig-025 width=50%}

## Проверка работы Dovecot

![Проверка того что письма доставлены](image/17-4.png){#fig-026 width=50%}

## Проверка работы Dovecot

Параллельно посмотрели, какие сообщения выдаются при мониторинге почтовой службы на сервере, а также при использовании doveadm и mail ([рис. @fig-027]), ([рис. @fig-028]), ([рис. @fig-029])

![Мониторинг работы почтовой службы после отправки тестовых писем](image/18-1.png){#fig-027 width=70%}

## Проверка работы Dovecot

![Просмотр имеющейся почты после отправки тестовых писем](image/18-2.png){#fig-028 width=70%}

## Проверка работы Dovecot

![Просмотр mailbox после отправки тестовых писем](image/18-3.png){#fig-029 width=70%}

## Проверка работы Dovecot

Далее проверили работу почтовой службы, используя на сервере протокол Telnet. Подключились с помощью протокола Telnet к почтовому серверу по протоколу POP3 (через порт 110), ввели свой логин для подключения и пароль ([рис. @fig-030]):

![Подключение к почтовому серверу с помощью протокола Telnet](image/19-1.png){#fig-030 width=70%}

## Проверка работы Dovecot

Далее использовали команды ```list```, ```retr 1```, ```dele 2``` и ```quit``` ([рис. @fig-031]):

![Работа с почтовым сервером через Telnet](image/19-2.png){#fig-031 width=40%}

## Внесение изменений в настройки внутреннего окружения виртуальной машины

На виртуальной машине server перешлм в каталог для внесения изменений в настройки внутреннего окружения */vagrant/provision/server/* и соответствующие подкаталоги поместили конфигурационные файлы Dovecot: ([рис. @fig-032]):

![Копирование конфигурационных файлов Dovecot в каталог dovecot](image/20.png){#fig-032 width=70%}

## Внесение изменений в настройки внутреннего окружения виртуальной машины

Далее внесли изменения в файл */vagrant/provision/server/mail.sh*, добавив в него строки по устанвке Dovecot и Telnet, по настройке межсетевого экрана,по настройке Postfix в части задания месторасположения почтового ящика, по перезапуску Postfix и запуску Dovecot ([рис. @fig-033])

## Внесение изменений в настройки внутреннего окружения виртуальной машины

![Редактирование файла mail.sh на сервере](image/21.png){#fig-033 width=40%}

## Внесение изменений в настройки внутреннего окружения виртуальной машины

На виртуальной машине client в каталоге */vagrant/provision/client* скорректировали файл *mail.sh*, прописав в нём ```dnf -y install evolution``` ([рис. @fig-034]): 

![Редактирование файла mail.sh на клиенте](image/22.png){#fig-034 width=60%}

# Подведение итогов

## Выводы

В ходе выполнения лабораторной работы №9 мы приобрели практические навыки по установке и простейшему конфигурированию POP3/IMAP-сервера.

## Список литературы

1. [Лаборатораня работа №9](https://esystem.rudn.ru/pluginfile.php/2854766/mod_resource/content/6/009-imap.pdf)
